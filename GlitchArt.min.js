export default class GlitchArt{constructor(t,i,h=10){this._canvas=null,this._ctx=null,this._dom=t,this._maxoffset=h,this.initCanvas(t),this.setBg(i)}initCanvas(t){if(this._dom=document.querySelector(t),this._canvas=document.createElement("canvas"),this._dom.appendChild(this._canvas),null!=this._canvas){this._ctx=this._canvas.getContext("2d");let{width:t,height:i,top:h,left:s}=this._dom.getBoundingClientRect();this._canvas.width=t,this._canvas.height=i;let e="width:100%;height:100%";this._canvas.style=e}else console.log("canvas null")}setBg(t){let i=new Image;i.src=t,i.onload=()=>{IsPC()?(this._dom.dpr=1,this._dom.width=i.width,this._dom.height=i.height):(this._dom.dpr=this._canvas.width/i.width,this._dom.width=i.width*this._dom.dpr,this._dom.height=i.height*this._dom.dpr),this.animation(i)}}animation(t){let i=0;const h=()=>{setTimeout(()=>{i<1e3?(this.draw(t),i+=100,h()):(this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._ctx.drawImage(t,0,0,this._dom.width,this._dom.height),setTimeout(()=>{i=0,h()},2e3))},30)};h()}draw(t){let i=0;for(this._ctx.clearRect(0,0,this._dom.width,this._dom.height);i<t.height;){let s=this.getRandom(3,~~(t.height/100*20));var h=this.getRandom(-Math.abs(this._maxoffset),this._maxoffset);this._ctx.drawImage(t,0,i,t.width,s,h,i*this._dom.dpr,this._dom.width,s*this._dom.dpr),i+=s}}getRandom(t,i){return Math.floor(Math.random()*(i-t+1))+t}}function IsPC(){for(var t=navigator.userAgent,i=new Array("Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"),h=!0,s=0;s<i.length;s++)if(t.indexOf(i[s])>0){h=!1;break}return h}